###################### Filebeat Configuration - WAF Logs ########################

filebeat.inputs:
  - type: filestream
    id: waf-threats
    enabled: true
    paths:
      - /var/log/caddy/waf_wan.log
      - /var/log/caddy/waf_lan.log
    parsers:
      - ndjson:
          target: ""

  - type: filestream
    id: blocked-ips
    enabled: true
    paths:
      - /var/log/caddy/blocked_ip_events.log
    parsers:
      - ndjson:
          target: ""

# ================================== Output ===================================
output.elasticsearch:
  hosts: ["https://10.246.50.82:9200"]
  username: "elastic"
  password: "KWZNH8hg3GQ64Sf"
  ssl:
    enabled: true
    verification_mode: none

# ================================== Logging ==================================
logging.level: info
logging.to_files: true
logging.files:
  path: /var/log/filebeat
  name: filebeat
